<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Short Gravity — System Map</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: #030305;
    color: #E5E7EB;
    font-family: 'JetBrains Mono', 'SF Mono', 'Fira Code', monospace;
    padding: 2rem;
  }
  h1 {
    color: #FFFFFF;
    font-size: 1.5rem;
    font-weight: 300;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
  }
  .subtitle {
    color: #71717A;
    font-size: 0.75rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 2rem;
  }
  .tabs {
    display: flex;
    gap: 0.25rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
  }
  .tab {
    padding: 0.5rem 1rem;
    background: transparent;
    color: #71717A;
    border: 1px solid #27272A;
    font-family: inherit;
    font-size: 0.7rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.2s;
  }
  .tab:hover { border-color: #52525B; color: #E5E7EB; }
  .tab.active { border-color: #FF6B35; color: #FF6B35; }
  .diagram {
    display: none;
    background: #0A0A0F;
    border: 1px solid #18181B;
    border-radius: 4px;
    padding: 2rem;
    margin-bottom: 2rem;
    overflow-x: auto;
  }
  .diagram.active { display: block; }
  .diagram .mermaid { display: flex; justify-content: center; }
  .diagram .mermaid svg { max-width: 100%; height: auto; }
  .stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
  }
  .stat {
    border: 1px solid #18181B;
    padding: 1rem;
    text-align: center;
  }
  .stat-value {
    color: #FFFFFF;
    font-size: 1.8rem;
    font-weight: 300;
  }
  .stat-label {
    color: #71717A;
    font-size: 0.65rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    margin-top: 0.25rem;
  }
  .legend {
    display: flex;
    gap: 1.5rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.7rem;
    color: #71717A;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  .legend-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }
  .table-section { margin-bottom: 2rem; }
  .table-section h3 {
    color: #FFFFFF;
    font-size: 0.8rem;
    font-weight: 400;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 0.75rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #18181B;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.75rem;
  }
  th {
    text-align: left;
    color: #71717A;
    font-weight: 400;
    font-size: 0.65rem;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid #18181B;
  }
  td {
    padding: 0.4rem 0.75rem;
    border-bottom: 1px solid #0F0F14;
    color: #E5E7EB;
  }
  td:first-child { color: #FFFFFF; }
  tr:hover td { background: #0F0F14; }
  .badge {
    display: inline-block;
    padding: 0.15rem 0.4rem;
    border-radius: 2px;
    font-size: 0.6rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
  }
  .badge-frequent { background: #FF6B3520; color: #FF6B35; border: 1px solid #FF6B3540; }
  .badge-hourly { background: #3B82F620; color: #3B82F6; border: 1px solid #3B82F640; }
  .badge-daily { background: #10B98120; color: #10B981; border: 1px solid #10B98140; }
  .badge-weekly { background: #8B5CF620; color: #8B5CF6; border: 1px solid #8B5CF640; }
  .badge-gh { background: #F59E0B20; color: #F59E0B; border: 1px solid #F59E0B40; }
  footer {
    margin-top: 3rem;
    padding-top: 1rem;
    border-top: 1px solid #18181B;
    color: #3F3F46;
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }
</style>
</head>
<body>

<h1>Short Gravity</h1>
<p class="subtitle">System Architecture Map</p>

<div class="stats">
  <div class="stat"><div class="stat-value">24</div><div class="stat-label">Active Workers</div></div>
  <div class="stat"><div class="stat-value">28</div><div class="stat-label">Database Tables</div></div>
  <div class="stat"><div class="stat-value">16</div><div class="stat-label">Data Sources</div></div>
  <div class="stat"><div class="stat-value">40+</div><div class="stat-label">API Routes</div></div>
  <div class="stat"><div class="stat-value">13K+</div><div class="stat-label">Brain Chunks</div></div>
  <div class="stat"><div class="stat-value">4,500+</div><div class="stat-label">FCC Filings</div></div>
</div>

<div class="tabs">
  <button class="tab active" onclick="showDiagram('pipeline')">Data Pipeline</button>
  <button class="tab" onclick="showDiagram('workers')">Worker Schedule</button>
  <button class="tab" onclick="showDiagram('database')">Database Map</button>
  <button class="tab" onclick="showDiagram('frontend')">Frontend</button>
  <button class="tab" onclick="showDiagram('brain')">Brain / RAG</button>
  <button class="tab" onclick="showDiagram('tables')">Full Reference</button>
</div>

<!-- PIPELINE DIAGRAM -->
<div id="pipeline" class="diagram active">
<div class="mermaid">
graph LR
  subgraph Sources["EXTERNAL SOURCES"]
    EDGAR["SEC EDGAR"]
    FCC_ICFS["FCC ICFS"]
    FCC_ECFS["FCC ECFS API"]
    FCC_ELS["FCC ELS"]
    STRACK["Space-Track.org"]
    FINNHUB["Finnhub"]
    AV["Alpha Vantage"]
    XAPI["X/Twitter API"]
    ACCESSWIRE["AccessWire"]
    ROIC["roic.ai"]
    PVIEW["PatentsView"]
    EPO["EPO OPS"]
    GPAT["Google Patents"]
    YFINANCE["Yahoo Finance"]
    ITU_SRC["ITU RB"]
    ISED_SRC["ISED Canada"]
    OFCOM_SRC["Ofcom UK"]
  end

  subgraph Workers["PYTHON WORKERS"]
    FW["filing_worker"]
    TW["tle_worker"]
    NW["news_worker"]
    PRW["press_release_worker"]
    EW["ecfs_worker"]
    IW["icfs_worker"]
    UW["uls_worker"]
    PW["patent_worker_v2"]
    PE["patent_enricher"]
    XW["x_worker"]
    TRW["transcript_worker"]
    PrW["price_worker"]
    SIW["short_interest_worker"]
    CPW["cash_position_worker"]
    GW["glossary_worker"]
    SS["signal_scanner"]
    LW["launch_worker"]
    ITU_W["itu_worker"]
    ISED_W["ised_worker"]
    OFCOM_W["ofcom_worker"]
    EMB["embedding_worker"]
  end

  subgraph DB["SUPABASE"]
    filings["filings"]
    fcc["fcc_filings"]
    patents["patents"]
    claims["patent_claims"]
    tle["satellites + tle_history"]
    xposts["x_posts"]
    press["press_releases"]
    transcripts["earnings_transcripts"]
    prices["daily_prices"]
    si["short_interest"]
    cash["cash_position"]
    glossary["glossary_terms"]
    signals["signals"]
    launches["next_launches"]
    chunks["brain_chunks"]
  end

  subgraph Frontend["NEXT.JS APP"]
    API["API Routes"]
    HUD["HUD Terminal"]
    BRAIN["Brain Search"]
    GLOBE["3D Globe"]
  end

  EDGAR --> FW --> filings
  FCC_ICFS --> IW --> fcc
  FCC_ECFS --> EW --> fcc
  FCC_ELS --> UW --> fcc
  STRACK --> TW --> tle
  FINNHUB --> NW
  XAPI --> XW --> xposts
  ACCESSWIRE --> PRW --> press
  ROIC --> TRW --> transcripts
  PVIEW --> PW --> patents
  EPO --> PW
  GPAT --> PE --> claims
  YFINANCE --> PrW --> prices
  YFINANCE --> SIW --> si
  AV --> API
  ITU_SRC --> ITU_W --> fcc
  ISED_SRC --> ISED_W --> fcc
  OFCOM_SRC --> OFCOM_W --> fcc

  filings --> CPW --> cash
  filings --> GW --> glossary
  filings --> SS --> signals
  press --> LW --> launches

  filings --> EMB
  fcc --> EMB
  patents --> EMB
  xposts --> EMB
  press --> EMB
  transcripts --> EMB
  EMB --> chunks

  chunks --> BRAIN
  filings --> API --> HUD
  tle --> API --> GLOBE

  style Sources fill:#0F0F14,stroke:#27272A,color:#E5E7EB
  style Workers fill:#0F0F14,stroke:#27272A,color:#E5E7EB
  style DB fill:#0F0F14,stroke:#FF6B3540,color:#E5E7EB
  style Frontend fill:#0F0F14,stroke:#3B82F640,color:#E5E7EB
</div>
</div>

<!-- WORKER SCHEDULE -->
<div id="workers" class="diagram">
<div class="legend">
  <div class="legend-item"><div class="legend-dot" style="background:#FF6B35"></div>Frequent (15min)</div>
  <div class="legend-item"><div class="legend-dot" style="background:#3B82F6"></div>Hourly (4h)</div>
  <div class="legend-item"><div class="legend-dot" style="background:#10B981"></div>Daily</div>
  <div class="legend-item"><div class="legend-dot" style="background:#8B5CF6"></div>Weekly</div>
  <div class="legend-item"><div class="legend-dot" style="background:#F59E0B"></div>GitHub Actions Only</div>
</div>
<div class="mermaid">
gantt
  title Worker Schedule (24h UTC)
  dateFormat HH:mm
  axisFormat %H:%M

  section Frequent
  filing_worker (every 2h weekdays)       :active, 06:00, 21:00
  tle_worker (every 6h)                   :active, 00:00, 23:59

  section Hourly
  news_worker (daily 13:00)               :13:00, 30m
  press_release_worker (daily 14:00)      :14:00, 30m

  section Daily
  patent_worker_v2 (06:00)                :06:00, 60m
  sec_filing_worker (08:00)               :08:00, 30m
  ecfs_worker (10:00)                     :10:00, 60m
  icfs_worker (12:00)                     :12:00, 60m
  embedding_worker (15:00)                :15:00, 60m
  launch_worker (15:30)                   :15:30, 30m
  staleness_alert (16:00)                 :16:00, 15m
  price_worker (22:00 weekdays)           :22:00, 30m

  section Twice Daily
  signal_scanner (13:00 + 21:00)          :13:00, 30m

  section Weekly
  glossary_worker (Sun 08:00)             :08:00, 60m
  uls_worker (Thu 10:00)                  :10:00, 30m
  transcript_worker (Wed 14:00)           :14:00, 30m
  widget_data_worker (Mon 15:00)          :15:00, 30m
  itu_worker                              :06:00, 30m
  ised_worker                             :06:30, 60m
  ofcom_worker                            :07:30, 60m
</div>
</div>

<!-- DATABASE MAP -->
<div id="database" class="diagram">
<div class="mermaid">
erDiagram
  satellites {
    text norad_id PK
    text name
    text tle_line1
    text tle_line2
    timestamp tle_epoch
  }
  tle_history {
    uuid id PK
    text norad_id FK
    timestamp epoch
    text source
  }
  conjunctions {
    uuid id PK
    text sat1_norad_id FK
    float collision_probability
  }
  filings {
    uuid id PK
    text accession_number UK
    text form
    date filing_date
    text content_text
    text summary
  }
  sec_filing_exhibits {
    uuid id PK
    uuid filing_id FK
    text exhibit_number
    text storage_path
  }
  fcc_filings {
    uuid id PK
    text filing_system
    text file_number UK
    text filing_type
    date filed_date
    text content_text
  }
  fcc_filing_attachments {
    uuid id PK
    uuid fcc_filing_id FK
    text filename
    text storage_path
  }
  patents {
    uuid id PK
    text patent_number UK
    text title
    text status
    date filing_date
  }
  patent_claims {
    uuid id PK
    text patent_number FK
    int claim_number
    text claim_type
    text claim_text
  }
  patent_families {
    uuid id PK
    text family_number UK
    jsonb publications
  }
  brain_chunks {
    uuid id PK
    text source_table
    text source_id
    int chunk_index
    vector embedding
  }
  signals {
    bigserial id PK
    text signal_type
    text severity
    jsonb source_refs
  }
  x_posts {
    bigserial id PK
    text tweet_id
    text sentiment
    text signal_type
  }
  press_releases {
    bigserial id PK
    text source_id UK
    text title
    timestamp published_at
  }
  daily_prices {
    uuid id PK
    text symbol
    date date
    numeric close
    bigint volume
  }
  profiles {
    uuid id PK
    text email
    text tier
    text patreon_id
  }

  satellites ||--o{ tle_history : "has history"
  satellites ||--o{ conjunctions : "involved in"
  filings ||--o{ sec_filing_exhibits : "has exhibits"
  fcc_filings ||--o{ fcc_filing_attachments : "has attachments"
  patents ||--o{ patent_claims : "has claims"
  patents }o--|| patent_families : "belongs to"
  brain_chunks }o--|| filings : "embeds"
  brain_chunks }o--|| fcc_filings : "embeds"
  brain_chunks }o--|| patents : "embeds"
  brain_chunks }o--|| x_posts : "embeds"
  brain_chunks }o--|| press_releases : "embeds"
</div>
</div>

<!-- FRONTEND -->
<div id="frontend" class="diagram">
<div class="mermaid">
graph TB
  subgraph Pages["ROUTES"]
    TERMINAL["/terminal — Main HUD"]
    PATENTS["/patents — Patent Browser"]
    RESEARCH["/research — Research Archive"]
    GALLERY["/gallery — Widget Showcase"]
    DEV["/dev/* — Development Pages"]
    SATELLITE["/satellite/[id] — Detail"]
    LANDING["/ — Landing Page"]
    LOGIN["/login — Auth"]
  end

  subgraph Components["COMPONENT LIBRARY"]
    direction TB
    subgraph Primitives["primitives/"]
      TEXT["Text"]
      STAT["Stat"]
      PANEL["Panel"]
      CHARTS["Charts"]
    end
    subgraph HUD["hud/"]
      LAYOUT["HUDLayout"]
      CONTROLS["ControlBar"]
      BRAIN_BAR["BrainBar"]
      WIDGETS["20+ Widgets"]
    end
    subgraph Earth["earth/"]
      GLOBE3D["Globe3D"]
      GROUND["GroundTrackMap"]
      SHADERS["Custom Shaders"]
    end
  end

  subgraph Data["DATA LAYER"]
    direction TB
    HOOKS["React Query Hooks"]
    STORES["Zustand Stores"]
    API_ROUTES["API Routes (40+)"]
    BRAIN_LIB["Brain Search Engine"]
  end

  subgraph External["EXTERNAL"]
    SUPABASE["Supabase"]
    FINNHUB_E["Finnhub"]
    SPACETRACK["Space-Track"]
    CLAUDE["Claude API"]
    OPENAI["OpenAI Embeddings"]
  end

  TERMINAL --> LAYOUT
  TERMINAL --> GLOBE3D
  TERMINAL --> WIDGETS
  TERMINAL --> BRAIN_BAR

  WIDGETS --> HOOKS
  GLOBE3D --> HOOKS
  BRAIN_BAR --> BRAIN_LIB

  HOOKS --> API_ROUTES
  BRAIN_LIB --> API_ROUTES
  API_ROUTES --> SUPABASE
  API_ROUTES --> FINNHUB_E
  API_ROUTES --> SPACETRACK
  BRAIN_LIB --> CLAUDE
  BRAIN_LIB --> OPENAI

  style Pages fill:#0F0F14,stroke:#27272A,color:#E5E7EB
  style Components fill:#0F0F14,stroke:#27272A,color:#E5E7EB
  style Data fill:#0F0F14,stroke:#FF6B3540,color:#E5E7EB
  style External fill:#0F0F14,stroke:#3B82F640,color:#E5E7EB
</div>
</div>

<!-- BRAIN / RAG -->
<div id="brain" class="diagram">
<div class="mermaid">
graph TB
  USER["User Query"] --> BRAIN_BAR["BrainBar Component"]
  BRAIN_BAR --> EXPAND["Query Expansion"]
  EXPAND --> EMBED["OpenAI Embedding"]
  EMBED --> VECTOR["pgvector Similarity Search"]
  EMBED --> KEYWORD["Full-Text Keyword Search"]

  VECTOR --> MERGE["Merge & Deduplicate"]
  KEYWORD --> MERGE

  MERGE --> RERANK["Claude LLM Reranking"]
  RERANK --> CONTEXT["Build Context Window"]

  subgraph Sources["SEARCHABLE SOURCES (13K+ chunks)"]
    S1["SEC Filings (530)"]
    S2["FCC Filings (4,500+)"]
    S3["Patents (307)"]
    S4["Patent Claims (2,482)"]
    S5["Press Releases"]
    S6["X Posts (2,000+)"]
    S7["Earnings Transcripts"]
  end

  VECTOR --> Sources
  KEYWORD --> Sources

  CONTEXT --> CLAUDE["Claude API"]
  CLAUDE --> RESPONSE["Answer + Citations"]
  RESPONSE --> BRAIN_BAR

  subgraph Pipeline["EMBEDDING PIPELINE (Daily 15:00 UTC)"]
    RAW["Raw Documents"] --> CHUNK["Chunk (~500 tokens)"]
    CHUNK --> HASH["Content Hash (skip unchanged)"]
    HASH --> OPENAI["OpenAI text-embedding-3-small"]
    OPENAI --> UPSERT["Upsert brain_chunks"]
  end

  style Sources fill:#0F0F14,stroke:#FF6B3540,color:#E5E7EB
  style Pipeline fill:#0F0F14,stroke:#8B5CF640,color:#E5E7EB
</div>
</div>

<!-- FULL REFERENCE TABLES -->
<div id="tables" class="diagram">

<div class="table-section">
<h3>Worker Schedule</h3>
<table>
<tr><th>Worker</th><th>Source</th><th>Table</th><th>Cadence</th></tr>
<tr><td>filing_worker.py</td><td>SEC EDGAR</td><td>filings</td><td><span class="badge badge-frequent">frequent</span></td></tr>
<tr><td>tle_worker.py</td><td>Space-Track</td><td>satellites, tle_history</td><td><span class="badge badge-frequent">frequent</span></td></tr>
<tr><td>news_worker.py</td><td>Finnhub</td><td>inbox</td><td><span class="badge badge-hourly">hourly</span></td></tr>
<tr><td>press_release_worker.py</td><td>AccessWire</td><td>press_releases</td><td><span class="badge badge-hourly">hourly</span></td></tr>
<tr><td>exhibit_backfill.py</td><td>SEC EDGAR</td><td>sec_filing_exhibits</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>icfs_servicenow_worker.py</td><td>FCC ICFS</td><td>fcc_filings</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>fcc_attachment_worker.py</td><td>FCC ELS/ICFS</td><td>fcc_filing_attachments</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>ecfs_worker.py</td><td>FCC ECFS API</td><td>fcc_filings</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>cash_position_worker.py</td><td>SEC filings</td><td>cash_position</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>patent_worker_v2.py</td><td>PatentsView/EPO</td><td>patents, patent_claims</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>transcript_worker.py</td><td>roic.ai</td><td>earnings_transcripts</td><td><span class="badge badge-daily">daily</span></td></tr>
<tr><td>x_worker.py</td><td>X/Twitter API</td><td>x_posts</td><td><span class="badge badge-gh">gh actions</span></td></tr>
<tr><td>price_worker.py</td><td>yfinance</td><td>daily_prices</td><td><span class="badge badge-gh">gh actions</span></td></tr>
<tr><td>signal_scanner.py</td><td>All tables</td><td>signals</td><td><span class="badge badge-gh">gh actions</span></td></tr>
<tr><td>launch_worker.py</td><td>press_releases</td><td>next_launches</td><td><span class="badge badge-gh">gh actions</span></td></tr>
<tr><td>embedding_worker.py</td><td>All content</td><td>brain_chunks</td><td><span class="badge badge-gh">gh actions</span></td></tr>
<tr><td>short_interest_worker.py</td><td>Yahoo Finance</td><td>short_interest</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>patent_enricher.py</td><td>Google Patents</td><td>patents</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>glossary_worker.py</td><td>Claude API</td><td>glossary_terms</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>uls_worker.py</td><td>fcc.report</td><td>fcc_filings</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>itu_worker.py</td><td>ITU RB</td><td>fcc_filings</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>ised_worker.py</td><td>ISED Canada</td><td>fcc_filings</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>ofcom_worker.py</td><td>Ofcom UK</td><td>fcc_filings</td><td><span class="badge badge-weekly">weekly</span></td></tr>
<tr><td>widget_data_worker.py</td><td>Multiple</td><td>widget_cache</td><td><span class="badge badge-weekly">weekly</span></td></tr>
</table>
</div>

<div class="table-section">
<h3>Database Tables</h3>
<table>
<tr><th>Table</th><th>Records</th><th>Primary Writer</th><th>Key Constraint</th></tr>
<tr><td>satellites</td><td>~30</td><td>tle_worker</td><td>PK: norad_id</td></tr>
<tr><td>tle_history</td><td>50,000+</td><td>tle_worker</td><td>UNIQUE(norad_id, epoch, source)</td></tr>
<tr><td>conjunctions</td><td>~100</td><td>tle_worker</td><td>UNIQUE(cdm_id)</td></tr>
<tr><td>filings</td><td>530</td><td>filing_worker</td><td>UNIQUE(accession_number)</td></tr>
<tr><td>sec_filing_exhibits</td><td>500+</td><td>exhibit_backfill</td><td>UNIQUE(accession, exhibit_number)</td></tr>
<tr><td>fcc_filings</td><td>4,500+</td><td>Multiple workers</td><td>UNIQUE(filing_system, file_number)</td></tr>
<tr><td>fcc_filing_attachments</td><td>1,000+</td><td>fcc_attachment_worker</td><td>—</td></tr>
<tr><td>patents</td><td>307</td><td>patent_worker_v2</td><td>UNIQUE(patent_number)</td></tr>
<tr><td>patent_claims</td><td>2,482</td><td>Claims fetchers</td><td>UNIQUE(patent_number, claim_number)</td></tr>
<tr><td>patent_families</td><td>29</td><td>populate_patent_families</td><td>UNIQUE(family_number)</td></tr>
<tr><td>press_releases</td><td>100+</td><td>press_release_worker</td><td>UNIQUE(source_id)</td></tr>
<tr><td>earnings_transcripts</td><td>~20</td><td>transcript_worker</td><td>UNIQUE(company, year, quarter)</td></tr>
<tr><td>inbox</td><td>1,000+</td><td>Multiple</td><td>UNIQUE(source, source_id)</td></tr>
<tr><td>x_posts</td><td>2,000+</td><td>x_worker</td><td>UNIQUE(source_id)</td></tr>
<tr><td>glossary_terms</td><td>500+</td><td>glossary_worker</td><td>UNIQUE(normalized_term)</td></tr>
<tr><td>short_interest</td><td>~50</td><td>short_interest_worker</td><td>—</td></tr>
<tr><td>cash_position</td><td>~20</td><td>cash_position_worker</td><td>—</td></tr>
<tr><td>daily_prices</td><td>1,000+</td><td>price_worker</td><td>UNIQUE(symbol, date)</td></tr>
<tr><td>next_launches</td><td>~5</td><td>launch_worker</td><td>—</td></tr>
<tr><td>signals</td><td>200+</td><td>signal_scanner</td><td>UNIQUE(fingerprint)</td></tr>
<tr><td>brain_chunks</td><td>13,000+</td><td>embedding_worker</td><td>UNIQUE(source_table, source_id, chunk_index)</td></tr>
<tr><td>brain_conversations</td><td>—</td><td>Brain API</td><td>—</td></tr>
<tr><td>brain_query_log</td><td>—</td><td>Brain API</td><td>—</td></tr>
<tr><td>worker_runs</td><td>—</td><td>GitHub Actions</td><td>—</td></tr>
<tr><td>profiles</td><td>—</td><td>Auth system</td><td>PK: auth.users.id</td></tr>
</table>
</div>

<div class="table-section">
<h3>API Routes</h3>
<table>
<tr><th>Route</th><th>Method</th><th>Purpose</th></tr>
<tr><td>/api/brain/query</td><td>POST</td><td>LLM query with citations</td></tr>
<tr><td>/api/brain/search</td><td>GET</td><td>Semantic + keyword search</td></tr>
<tr><td>/api/filings</td><td>GET</td><td>List SEC filings</td></tr>
<tr><td>/api/filings/fcc</td><td>GET</td><td>List FCC filings</td></tr>
<tr><td>/api/filings/search</td><td>GET</td><td>Full-text filing search</td></tr>
<tr><td>/api/patents</td><td>GET</td><td>Patent portfolio</td></tr>
<tr><td>/api/patents/stats</td><td>GET</td><td>Patent statistics</td></tr>
<tr><td>/api/stock/[symbol]</td><td>GET</td><td>Current quote (Finnhub)</td></tr>
<tr><td>/api/stock/[symbol]/candles</td><td>GET</td><td>OHLCV data</td></tr>
<tr><td>/api/satellites/batch-tle</td><td>GET</td><td>Multi-satellite TLE</td></tr>
<tr><td>/api/constellation/stats</td><td>GET</td><td>Fleet health</td></tr>
<tr><td>/api/widgets/*</td><td>GET</td><td>20+ widget data endpoints</td></tr>
<tr><td>/api/system/health</td><td>GET</td><td>API health check</td></tr>
<tr><td>/api/auth/patreon</td><td>POST</td><td>OAuth initiation</td></tr>
</table>
</div>

</div>

<footer>
  Short Gravity System Map — Auto-generated Feb 2026
</footer>

<script src="https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js"></script>
<script>
  mermaid.initialize({
    startOnLoad: true,
    theme: 'dark',
    themeVariables: {
      darkMode: true,
      background: '#0A0A0F',
      primaryColor: '#FF6B35',
      primaryTextColor: '#E5E7EB',
      primaryBorderColor: '#27272A',
      lineColor: '#52525B',
      secondaryColor: '#18181B',
      tertiaryColor: '#0F0F14',
      fontFamily: 'JetBrains Mono, SF Mono, monospace',
      fontSize: '12px',
      edgeLabelBackground: '#0A0A0F',
      nodeTextColor: '#E5E7EB',
      clusterBkg: '#0A0A0F',
      clusterBorder: '#27272A',
      titleColor: '#FFFFFF',
    },
    flowchart: { curve: 'basis', padding: 15 },
    er: { fontSize: 11 },
    gantt: {
      fontSize: 11,
      barHeight: 20,
      topPadding: 40,
      sidePadding: 60,
    }
  });

  function showDiagram(id) {
    document.querySelectorAll('.diagram').forEach(d => d.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
  }
</script>
</body>
</html>
